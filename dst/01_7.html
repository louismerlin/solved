<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>THE FUTURE IS SOLVED</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
/*! concrete.css v3.0.0 | MIT License | github.com/louismerlin/concrete.css */
:root{--fg:#111;--bg:#fff}@media (prefers-color-scheme:dark){:root{--fg:#fff;--bg:#111}}html{font-size:1.25rem;box-sizing:border-box}*,::after,::before{box-sizing:inherit;text-decoration-thickness:.1rem}body{background:var(--bg);font-family:Helvetica,Arial,sans-serif}a,body{color:var(--fg)}body,figure{margin:0}figcaption{text-align:right;font-size:.8em;border-bottom:.2rem solid var(--fg);padding-bottom:.2rem}img{max-width:100%;height:auto}main section+section{padding:2rem 0}body>footer,body>header,body>main{margin:auto;max-width:660px;padding-left:10px;padding-right:10px;width:100%}body>header{padding-top:8rem;padding-bottom:8rem;font-size:1.2em}h1{font-size:2em}h2{font-size:1.5em}h3{font-size:1.17em}h4{font-size:1em}h5{font-size:.83em}h6{font-size:.67em}footer{text-align:center}button,input[type=button],input[type=reset],input[type=submit]{display:inline-block;vertical-align:middle;padding:.2rem .5rem;font-size:1rem;font-weight:400;margin-bottom:.5rem;background:var(--bg);color:var(--fg);border:.1rem solid var(--fg);border-radius:0;cursor:pointer}button:disabled,input[type=button]:disabled,input[type=reset]:disabled,input[type=submit]:disabled{border-style:dashed;cursor:not-allowed}ul{list-style:square}nav{margin:2rem 0}nav ul{padding:0;list-style:none}nav ul li{margin:0 .2rem;display:inline-block}fieldset{border:.1rem solid var(--fg)}label,legend{display:block;font-weight:700;margin-bottom:.4rem}input[type=email],input[type=number],input[type=password],input[type=search],input[type=tel],input[type=text],input[type=url],select,textarea{-webkit-appearance:none;-moz-appearance:none;appearance:none;box-shadow:none;box-sizing:inherit;padding:.2rem .5rem;width:100%;font-size:1rem;color:var(--fg);background-color:var(--bg);border:.1rem solid var(--fg);border-radius:0;font-family:Helvetica,Arial,sans-serif}fieldset,input,select,textarea{margin:0 0 .8rem}input::placeholder,textarea::placeholder{color:var(--fg);font-style:italic;opacity:1}table{width:100%;border-spacing:0}td,th{padding:.4rem}td:first-child,th:first-child{padding-left:0}td:last-child,th:last-child{padding-right:0}th{border-bottom:.1rem solid var(--fg);text-align:left}td{border-bottom:.05rem solid var(--fg)}blockquote,pre{margin-left:0;margin-right:0;padding:.5rem .8rem;border-left:.1rem solid var(--fg);overflow-y:hidden}pre{border:.05rem dotted var(--fg)}pre>code{white-space:pre;display:block;font-size:.8rem}progress{-moz-appearance:none;-webkit-appearance:none;display:block;height:.5rem;overflow:hidden;padding:0;width:100%;background:var(--bg);color:var(--fg);border:.1rem solid var(--fg);border-radius:0}progress::-webkit-progress-bar{background-color:var(--bg)}progress::-webkit-progress-value{background-color:var(--fg)}progress::-moz-progress-bar{background-color:var(--fg)}hr{border:.05rem solid var(--fg)}

:root {
  --neon-pink: #ec008c;
  --neon-green: #1cfe23;
  --neon-yellow: #ffff00;
  --neon-blue: #00ffff;
  --neon-orange: #ff4500;
}
html {
  font-size: 1rem;
}
body>footer, body>header, body>main {
  max-width: 960px;
}
h1 {
  font-family: monospace;
  border-left: 0.3rem solid var(--neon-yellow);
  padding-left: 0.5rem;
}
h2 {
  border-left: 0.3rem solid var(--neon-blue);
  padding-left: 0.5rem;
}
a {
  text-decoration-color: var(--neon-orange);
}
pre {
  border-left: .3rem solid var(--neon-pink);
}
blockquote {
  border-left-color: var(--neon-green);
  border-width: .3rem;
}
</style>
</head>
<body>
<main>
<br>
<p><a href="../">back to home</a></p>
<h1>OGN Challenge #7</h1>
<h2>The Setup</h2>
<blockquote>
<p>Wheeler wants to transfer the funds from the card, but we need some personal information. The account seems to be linked to Darius Gift, who had an obituary published recently. Can you gather the information we need and gain access to the funds?</p>
</blockquote>
<p>You'll find two key pieces in the comic and on the webpage:</p>
<ol>
<li>A <strong>barcode</strong> containing encoded card data</li>
<li>A link to <strong>Tropic Bank's transfer form</strong></li>
</ol>
<p>The challenge also provides this Python script (<code>encoder.py</code>):</p>
<pre><code class="language-python"># pip install msgpack 
import msgpack
import base64

card_data = {
    &quot;card&quot;: 12345678900000,
    &quot;pin&quot;: &quot;1a2b3c&quot;
}

packed = msgpack.packb(card_data)
encoded = base64.b64encode(packed)

# https://gchq.github.io/CyberChef/#recipe=To_MessagePack()To_Base64('A-Za-z0-9%2B/%3D')&amp;input=ewogICAgImNhcmQiOiAxMjM0NTY3ODkwMDAwMCwKICAgICJwaW4iOiAiMWEyYjNjIgp9&amp;oeol=VT
</code></pre>
<h2>What the Bank Form Requires</h2>
<p>The transfer form needs these four pieces of information:</p>
<ul>
<li><strong>Sender Account Number</strong></li>
<li>What is the <strong>name</strong> of your current agent?</li>
<li>What <strong>city</strong> do you currently live in?</li>
<li>What is the <strong>title</strong> of your first published work?</li>
</ul>
<h3>Part 1: Decoding the Card Data</h3>
<p>The barcode gives us encoded information. When we scan it with a <a href="https://barcodescanneronline.com/">barcode scanner</a>, we get: <code>gqRjYXJkzwAAIYgxWHbco3Bpbs0SmA==</code></p>
<p>This looks like base64-encoded data! Looking at the <code>encoder.py</code> script, we can see the encoding process:</p>
<ol>
<li>Pack data with MessagePack</li>
<li>Encode result with Base64</li>
</ol>
<p>To reverse this process:</p>
<pre><code>Base64::encode(MessagePack::pack(data))
becomes
MessagePack::unpack(Base64::decode(data))
</code></pre>
<p>Using <a href="https://gchq.github.io/CyberChef/#recipe=From_Base64(&#x27;A-Za-z0-9%2B/%3D&#x27;,true,false)From_MessagePack()&amp;input=Z3FSallYSmt6d0FBSVlneFdIYmNvM0JwYnMwU21BPT0&amp;oeol=VT">CyberChef to decode</a>, we get:</p>
<pre><code class="language-json">{
    &quot;card&quot;: 36868827150044,
    &quot;pin&quot;: 4760
}
</code></pre>
<p>Perfect! The sender account number is <strong>36868827150044</strong>.</p>
<h2>Part 2: Finding Darius Gift's Personal Info</h2>
<p>The remaining three security questions can be answered by locating Darius Gift's obituary in the comic.</p>
<ul>
<li><strong>Agent name</strong>: TODO</li>
<li><strong>Current city</strong>: TODO</li>
<li><strong>First published work title</strong>: TODO</li>
</ul>
<h2>Part 3: Completing the Transfer</h2>
<p>Once we have all four pieces of information, we can fill out the Tropic Bank form and complete the fund transfer.</p>
<p>TODO</p>
<br>
<footer>
<p>
<a href="https://louismerl.in/">Louis Merlin</a> Â© <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">BY-NC-SA 4.0</a> | <a href="https://github.com/louismerlin/solved/">Code</a>
</p>
</footer>
</main>
</body>
</html>
